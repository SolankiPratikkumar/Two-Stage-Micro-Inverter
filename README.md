# Two Stage Micro-Inverter PCB Design:

## Schematic Level 1 Micro-Inverter:

<img width="936" height="581" alt="image" src="https://github.com/user-attachments/assets/b9d094aa-3972-4a05-942f-c5cbd418966d" />

## Blocks & Functionality:

### PV Voltage Sense:
<img width="977" height="96" alt="image" src="https://github.com/user-attachments/assets/7f53eccf-5411-46f4-b038-3e2b7f697af8" />

### PV Current Sense:
<img width="977" height="96" alt="image" src="https://github.com/user-attachments/assets/df938cea-a3be-47d5-8bc7-af4c270ccd44" />

### DC/DC Converter:
<img width="977" height="126" alt="image" src="https://github.com/user-attachments/assets/c31831a5-41a2-45c1-8b13-1b9cfa1490af" />

### DC/AC Inverter:
<img width="977" height="126" alt="image" src="https://github.com/user-attachments/assets/b26522f5-fddb-4f79-bf9c-e0b2f7682402" />

### Grid Connection:
<img width="977" height="96" alt="image" src="https://github.com/user-attachments/assets/3eba0cb1-e089-44b2-b907-5911cecd169b" />

### Grid Voltage Sense:
<img width="977" height="96" alt="image" src="https://github.com/user-attachments/assets/d07bde96-c381-4e30-b407-0d5d22479bbb" />

### Grid Current Sense:
<img width="977" height="96" alt="image" src="https://github.com/user-attachments/assets/92f0eec4-0cea-4eac-b8c4-808d4eb5425d" />

### Flyback Gate Driver:
<img width="977" height="126" alt="image" src="https://github.com/user-attachments/assets/bf563292-d503-4eea-bd37-0a1ccc3f8380" />

### Inverter Gate Driver:
<img width="977" height="126" alt="image" src="https://github.com/user-attachments/assets/a989e80c-f71c-43ee-8128-005b87c8df55" />

### Power Supply Units:  
<img width="977" height="126" alt="image" src="https://github.com/user-attachments/assets/b95ad2f1-45ca-4890-b54c-808a1ade7ffc" />

### Microcontroller & Display:
<img width="977" height="126" alt="image" src="https://github.com/user-attachments/assets/4a2dd907-9329-4889-9f32-630e1d1f9de9" />

## Frequent Asked Question:
### (Q) What is Microinverter?
### Solution: 
* A microinverter is a device used in solar power systems to convert the direct current (DC) electricity generated by a single solar panel into alternating current (AC) electricity suitable for use in homes or businesses or any other application.
* A microinverter extracts and converts energy from PV module and to boost efficiency, microinverters employ Maximum Power Point Tracking (MPPT), optimizing the PV module's operating voltage for peak efficiency under any conditon.

### (Q) How is Power Supply Unit(PSU) is connected and its Flow?
### Solution: 
* The Power Supply Unit have the inputs from external supply and from PV module(pin PV+) generated output of upto 24V so it can use any of the input and generate the output of +12V,+5V for primary circuit and generates secondary outputs of +12V, + 5 and it uses +2V , +1.65V as reference voltage for Voltage Regulator with High PSRR and Shunt Regulator and capacitor banks circuits.

## Connection & Flow & I/O Pins of Level 1 Micro-Inverter: 
### PV Module: 
* Converts solar irradiance into electrical energy of DC of range 0- 25V, providing voltage and current based on sunlight intensity as an output to through PV+ and PV- Terminals.
### PV Voltage Sense: 
* Measures PV voltage using PV+ providing sensed value by VPV_SEN output pin to Microcontroller of 3.3V output and to Display the reading using microcontroller and also the input voltages of 5V primary , 3.3V secondary are input use for operating this block from PSUs.
### PV Current Sense: 
* It uses the PV- pin for reading the current value generated by PV module and for operating this block we use 5V secondary input from PSUs and the sensed output reading are send to Microcontroller and Display block by IPV_SEN pin.
### DC-DC Converter: 
* It is 1:4 Boost converter which step up 0-24V,0-10A maximum input through pin PV+ and PV- to 180V, 1A output which is almost the voltage ranges we use for generation of AC output for Grid Level through pin VBUS.Also it uses 12V PWM signal for Duty cycle and MPPT algorithm signal through pins FLYBACK_DRV_1A and VS1.
### DC/AC Inverter: 
* It converts DC power through input pin VBUS to AC through pin HBRIDGE2 and AC_N_OUT for grid-tied operation, supported by the Inverter Gate Driver and microcontroller using duty cycle for operating Q3,Q4,Q5,Q6 Transistor through pin INV_DRV_1H and pin INV_DRV_2L. also it uses LCL Filter because the output is not perfect sine from this transistor.
### Grid Connection: 
* Allows electricity AC through input pin HBRIDGE2 and AC_N_OUT from the inverter to be fed into the Grid through output pins N and L.Also its readings are sense by microcontroller from GRID_RLY_CTRL pin to Display it. And it uses +12V_SEC DC from PSU to its internal circuits.
### Flyback Gate Driver: 
* Provides isolation and controls the DC/DC converter's switching operation and its inputs pins are received from FLYBACK_PWM_1A and FLYBACK_PWM_1B through microcontroller block by MPPT Algorithm Tracking.The input power pins to circuitry of this block are +5V Primary and 3.3V Secondary . Also the generated output are received to
output by pins VS1 and FLYBACK_DRV_1A for DC-DC Converter.
### Inverter Gate Driver: 
* It provide the PWM signal from microcontroller by input pins INV_PWM_1H and INV_PWM_2L to DC-AC Inverter block using output pins of INV__1H and INV_DRV_2L and it is powered by +12V Secondary and the VBUS voltage value is also sense by this block to send information to microcontroller and display it .
### Grid Voltage Sense: 
* Measures grid voltage using pins L and N and for the circuit operation we need to use reference voltage of 3.3V and 1.65V with the zero crossing detector to output pin V_ZERO_TST to finally produce frequency count and readings for output through pin VGRID_SEN which is given to microcontroller and display.
### Grid Current Sense: 
* Measures grid current using input pins HBRIDGE2 and AC_N_OUT and for the circuit operation we need to use 5V and 3.3V secondary from PSU. And the output generated at pin IGRID_SEN which is given to microcontroller and display to produce present value of AC Grid.
### Microcontroller & Display : 
* It is the main control block of the system to sense the DC inputs of PV,DC-DC Converter, DC-AC Inverter, Grid AC Voltage and current values and produce the Display Reading and also to produce the ouput PWM signal for Flyback Gate driver circuits and Inverter Gate driver Circuit using internally USB Port so that by MATLAB or other software we can run the MPPT Algorithm software as there is processing IC FT2232HQ-REEL is used along with ATMEGA 328P IC which will produce the Duty cycle and by processing through I2C lines of SCL,SDA,SCK we would get the readings on Display of all the inputs and outputs.

## Schematics Level-2 Microinverter:

### PV Module:
<img width="937" height="545" alt="image" src="https://github.com/user-attachments/assets/47c42741-45c7-476b-8a21-d3cc0e916e11" />

* The Solar Sunlight generated produces the DC Voltage from each solar module which is connected to the PV+ and PV- pin of this circuits. The voltage generated is directly proportional to irradiance ,intensity and reflection absorbed by the solar plates.
* We are assuming here the fact that each Solar module can produce 180W of power supply we add the series and parallel plates according to the our need.

### DC-DC Converter:

<img width="936" height="575" alt="image" src="https://github.com/user-attachments/assets/f1d7f5c2-58c9-4c86-be49-f28ab4bfe94d" />

* On the primary side of the switching converter, IRFB4310 MOSFETs are utilized due to their advantageous characteristics, including a low R_DS-On (5.6mΩ), high V_DS (100V), and a current rating of 130A. These specifications are crucial for enhancing the efficiency of the DC/DC converter, facilitating the passage of up to 200W of power through this section.
* The NA5919-AL transformers employed are 1:4 flyback transformers, is chosen to elevate the voltage output from the PV module. Transitioning to the secondary side of the DC/DC Converter, a voltage doubler circuit and the DC link capacitor are prominent features.
* The voltage doubler circuit comprises a 2μF capacitor, chosen based on previous simulations, along with two MSRF1560G power rectifier diodes. These diodes boast a low forward voltage (1.5V), coupled with high voltage (600V) and current (15A) ratings, ensuring efficient energy conversion and robust performance.
* An indicator neon bulb (LED1) is incorporated on the secondary side to provide a visual indication of voltage presence, typically over approximately 60V on the DC link capacitors. A resistor value of R5 is 150KΩ was selected based on the specifications provided in the datasheet for the neon indicator bulb.
* Furthermore, FUSE1 plays a pivotal role in isolating the converter section from the inverter section when independent testing of the converter section is required. This fuse acts as a protective measure, preventing potential damage to the converter or inverter components and ensuring safe operation during testing procedures.

* Main Components & Mouser URLs:
  
* T1 & T2-->> Audio Transformers/Signal Transformers DA2032 Cap Charger For Linear
* LT3750-->>> https://www.mouser.in/ProductDetail/Coilcraft/DA2032-ALD?qs=ZYnrCdKdyefv4mcPD%252BT0WQ%3D%3D
* J1-->Fixed Terminal Blocks 3 POS SIDE ENT 3.5MM-->>https://www.mouser.in/ProductDetail/TE-Connectivity/1776275-3?qs=vnwGVgFuQiaG2mifqnUIBA%3D%3D

### DC-AC Inverter:
<img width="1028" height="562" alt="image" src="https://github.com/user-attachments/assets/db78995b-36bc-4182-917b-21cea243cbd7" />

* The DC/AC inverter section of the microinverter is comprised of two essential components: an H-Bridge and an LCL filter. This section plays a pivotal role in converting the direct current (DC) output from the DC/DC converter into alternating current (AC) suitable for powering electrical devices.
* At the core of the H-Bridge circuit are SIHP25N40D Power MOSFETs, meticulously chosen for their robust characteristics, including a high drain-source voltage (V_DS) rating of 450V and a significant drain current (I_DS) capacity of 24A.
* These MOSFETs facilitate efficient switching operations within the H-Bridge configuration, ensuring seamless conversion of DC to AC power.
* In conjunction with the H-Bridge, the LCL filter (comprised of inductors L1 and L2, resistor R6, and capacitor C6) serves to refine the output waveform and mitigate harmonic distortions.
* These components are meticulously selected and precisely tuned to optimize the performance of the microinverter, enhancing its overall efficiency and reliability. The utilization of the SIHP25N40D MOSFETs in the H-Bridge, coupled with the carefully designed LCL filter, underscores the meticulous engineering and attention to detail employed in the design of the microinverter.
* Together, these components work harmoniously to ensure the seamless conversion of DC power from the solar panels into clean and reliable AC power for residential or commercial applications.
* Main Components & Mouser URLs:
  
* Q3,Q4,Q5,Q6 Transistors -->>> SIHP25N40D-GE3 -->> MOSFET 400V Vds 30V Vgs TO-220AB-->> https://www.mouser.in/ProductDetail/Vishay-Semiconductors/SIHP25N40D-GE3?qs=CJFgc%252B3p06hr07bri6UKRA%3D%3D

